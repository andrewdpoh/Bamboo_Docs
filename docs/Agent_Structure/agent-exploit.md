# agent/exploit

The package used to run exploits, either by injection or dropping and running from disk

## File Functions

### DropFile

Write a file from a variable to the disk

|Parameter|Type|Description|
|-----|----|-----------|
|exe|[]byte|The contents of the file|
|filename|string|Name of file to use|

**Return**

|Type|Description|
|----|-----------|
|error|Error created if any|

### DeleteExeFile

Deletes a file (usually an executable) from disk. This function will first try to rename it to a placeholder name that does not have the .exe extension before deleting to evade the [Process Termination followed by Deletion](https://www.elastic.co/guide/en/security/current/process-termination-followed-by-deletion.html) rule.

|Parameter|Type|Description|
|-----|----|-----------|
|filename|string|Name of file to delete|

**Return**

|Type|Description|
|----|-----------|
|error|Error created if any|

### DropToDisk

Uses the DropFile function to create a file and execute it with a shell. 

|Parameter|Type|Description|
|-----|----|-----------|
|exe|[]byte|The contents of the file|

**Return**

|Type|Description|
|----|-----------|
|error|Error created if any|

## Injection Functions

### VirturalAlloc

Performs Virtural Allocation injection. For more information, refer to 

|Parameter|Type|Description|
|-----|----|-----------|
|payload|string|Hex string of shellcode to run|

**Return**

|Type|Description|
|----|-----------|
|error|Error created if any|

### RemoteThreadInjection

Performs Remote Thread injection in OneDrive.exe. For more information, refer to 

|Parameter|Type|Description|
|-----|----|-----------|
|payload|string|Hex string of shellcode to run|

**Return**

|Type|Description|
|----|-----------|
|error|Error created if any|

### NtDllGadgetInjection

Performs NtQueueApcThreadEx NTDLL Gadget Injection. For more information, refer to 

|Parameter|Type|Description|
|-----|----|-----------|
|payload|string|Hex string of shellcode to run|

**Return**

|Type|Description|
|----|-----------|
|error|Error created if any|

