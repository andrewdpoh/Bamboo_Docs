# agent/post-exploit

Package for the functions to perform system enumeration and post exploitation. For more details on how they work, refer to [post-exploitation](../../post_exploitation.md).

## Enumeration function

### powershellCsv

Run a command in powershell

**Parameters**

|Parameter|Type|Description|
|-----|----|-----------|
|command|string|Command to run|

**Return**

|Type|Description|
|----|-----------|
|string|Output of command|
|error|Error from command if any|

### EnumerateSystem

Uses powershellCsv to run specific commands for enumerating the host system  

- System Information  
- Updates installed  
- Applications installed

**Parameters**

None

**Return**

|Type|Description|
|----|-----------|
|map[string]string|Result of command|
|error|Error from command if any|

## Keylogger

### hookKeylog

Listens and records keys entered

**Parameters**

|Parameter|Type|Description|
|-----|----|-----------|
|evChan|chan hook.Event|Listens to keyboard activity|

**Return**

None

### RunKeylogger

Starts the keylogging function, and listens for a stop command to stop and transfer logged keys

**Parameters**

|Parameter|Type|Description|
|-----|----|-----------|
|keystrokesChan|chan string|Channel out of function which returns keys logged|
|stopChan|chan bool|Channel into function to instruct it to stop|

**Return**

None

## Retrieve Registry Hives (sssretrieve)

### getLatestShadowCopy

Get the latest shadow copy volume

**Parameters**

None

**Return**

|Type|Description|
|----|-----------|
|string|The latest shadow copy volume|
|error|Error from command if any|

### readFile

Read the contents of a file

**Parameters**

|Parameter|Type|Description|
|-----|----|-----------|
|sourceFile|string|Path of file to read|

**Return**

|Type|Description|
|----|-----------|
|[]byte|Contents of file|
|error|Error created if any|

### readFilesFromShadowCopy

Read the contents of the registry hives (sam, security, system) given the shadow copy 

**Parameters**

|Parameter|Type|Description|
|-----|----|-----------|
|shadowCopyVolume|string|Location of latest shadow copy|

**Return**

|Type|Description|
|----|-----------|
|map[string][]byte|Contents of files|
|error|Error created if any|

### SSSRetriver

Runs the registry hive retriever function, by using the functions above 

**Parameters**

None

**Return**

|Type|Description|
|----|-----------|
|map[string][]byte|Contents of files|
|error|Error created if any|
