# Model Class - exploits

<!-- models, collections, and global_var with back ticks is to be link (n remove back ticks) -->
<!-- commands within braces {} are to be link as well -->

This class contains all models related to exploits. Bamboo Teamserver makes use of the functions within this class to find, update, add, and delete exploits information stored in the database according to Bamboo Client command. This class will be interacting with the [exploits](../Database/collections.md#exploits) collection only

<!-- Func 1 -->

## view_all

Retrieve all exploits information

### Usage
<!-- should link both endpoint n command to their respective pages -->
```
POST /exploits/view_all
```

### Description

view_all retrieves all exploits information stored in the database from the [exploits](../Database/collections.md#exploits) collection.

#### Function Arguments

**Does not require any arguments**

### Database Method

|Method|Collection|Return|
|------|----------|------|
|find|exploits|Dictionary of all exploit information in the collection|

### Function Return

|Type|Description|
|----|-----------|
|List|List of all exploit information in the collection|

### Return Example

```
[
  {
    "name": "filmora.exe",
    "app_version": "Wondershare Filmora v11",
    "LPE_start": "admin",
    "LPE_end": "system",
    "uac_bypass": true,
    "drop-to-disk": true,
    "inject": true,
    "drop_file": "filmora.exe"
  },
  {
    "name": "wacom.exe",
    "app_version": "Wacom Tablet 6.3.45-1",
    "LPE_start": "user",
    "LPE_end": "system",
    "uac_bypass": false,
    "drop-to-disk": true,
    "inject": true,
    "drop_file": ""
  }
]
```

<!-- Func 2 -->
<br>

## add_exploit

Insert new exploit into database

### Usage
<!-- should link both endpoint n command to their respective pages -->
```
POST /exploits/add
```

### Description

Insert a new exploit into the database `collection exploits`.

#### Function Arguments

|Field|Type|Description|
|-----|----|-----------|
|configuration|String|List of new exploit information|

### Arguments Example

```
add_exploit(["newExploit.exe", "app_version_Bamboo", "user", "system", False, True, True, ""])
```

### Database Method

|Method|Collection|Return|
|------|----------|------|
|insert_one|exploits|Dictionary exploit information to be added|

### Insert Example

```
new_exploit = {
    "name": "newExploit.exe",
    "app_version": "app_version_Bamboo",
    "LPE_start": "user",
    "LPE_end": "system",
    "uac_bypass": False,
    "drop-to-disk": True,
    "inject": True,
    "drop_file": ""
}
```

### Function Return

|Type|Description|
|----|-----------|
|Boolean|Status of insertion|

### Return Example

```
True
```

<!-- Func 3 -->
<br>

## del_exploit

Delete specified exploit from database

### Usage
<!-- should link both endpoint n command to their respective pages -->
```
POST /exploits/delete
```

### Description

Delete an existing exploit from the database `collection exploits`.

#### Function Arguments

|Field|Type|Description|
|-----|----|-----------|
|exploit_name|String|Name of exploit to be deleted|

### Arguments Example

```
del_exploit("wacom.exe")
```

### Database Method

|Method|Collection|Return|
|------|----------|------|
|find_one|exploits|List of information of specified exploit, None of does not exist|
|delete_many|exploits|Delete all instance of specified exploit name|

### Function Return

|Type|Description|
|----|-----------|
|Dictionary|Status of deletion|

### Return Example

```JSON
{"status": "success"}
```

<!-- Func 4 -->
<br>

## find_one

Retrieve information of a specified exploit

### Usage
<!-- should link both endpoint n command to their respective pages -->
```
POST /exploits/exist
```

### Description

Retrieve all information regarding the specified exploit from the `collection exploits`.

#### Function Arguments

|Field|Type|Description|
|-----|----|-----------|
|exploit_name|String|Name of exploit|

### Arguments Example

```
find_one("wacom.exe")
```

### Database Method

|Method|Collection|Return|
|------|----------|------|
|find_one|exploits|List of information of specified exploit, None of does not exist|

### Function Return

|Type|Description|
|----|-----------|
|Dictionary|Status of retrieving, list of data if applicable|

### Return Example

```JSON
{
    "status": "success",
    "data": {
        "name": "wacom.exe",
        "app_version": "Wacom Tablet 6.3.45-1",
        "LPE_start": "user",
        "LPE_end": "system",
        "uac_bypass": false,
        "drop-to-disk": true,
        "inject": true,
        "drop_file": ""
    }
}
```

<!-- Func 5 -->
<br>

## modify

Modify specified exploit information (for Bamboo Client CLI)

### Usage
<!-- should link both endpoint n command to their respective pages -->
```
POST /exploits/modify
```

### Description

Modify information of exploit specified in `collection exploits`. Changes to be made will differ, therefore this model can dynamically modify the number of changes to be made accordingly.

#### Function Arguments

|Field|Type|Description|
|-----|----|-----------|
|exploit_name|String|Name of exploit to be modified|
|changes|List|List of changes to be made (differ accordingly)|

### Arguments Example

```
modify("wacom.exe", ["name": "wacow.exe"])
```

### Database Method

|Method|Collection|Return|
|------|----------|------|
|update_many|exploits|Status of update|

### Update Example

```JSON
{
    "name": exploit_name
}, 
{"$set": 
    {key: new_value}
}
```

### Function Return

|Type|Description|
|----|-----------|
|Boolean|Status of update|

### Return Example

```
True
```

<!-- Func 6 -->
<br>

## modify_gui

Modify specified exploit information (for Bamboo Client GUI)

### Usage
<!-- should link both endpoint n command to their respective pages -->
```
POST /exploits/modify_gui
```

### Description

Modify information of exploit specified in `collection exploits`. Unlike the previous model, this model caters for the GUI, which will update all information of the specified exploit even if there are still the same.

#### Function Arguments

|Field|Type|Description|
|-----|----|-----------|
|modified_exploit_name|String|Name of exploit to be modified|
|new_name|String|Name to replace with|
|new_app_version|String|App version to be replace with|
|new_LPE_start|String|LPE start to be replace with|
|new_LPE_end|String|LPE end to be replace with|
|new_uac_bypass|Boolean|Uac_bypass to be replace with|
|new_d2d|Boolean|Drop-to-disk to be replace with|
|new_inj|Boolean|Injection to be replace with|
|new_dropfile|String|Dropfile to be replace with| 

### Arguments Example

```
modify_gui("wacom.exe", "wacow.exe", "Wacom Tablet 6.3.45-1", "admin", "system", "true", "true", "false", "wacow.exe")
```

### Database Method

|Method|Collection|Return|
|------|----------|------|
|update_many|exploits|Status of update|

### Update Example

```JSON
{
    "name": exploit_name
}, 
{"$set": 
    {
        "name": new_name,
        "app_version": new_app_version,
        "LPE_start": new_LPE_start,
        "LPE_end": new_LPE_end,
        "uac_bypass": new_uac_bypass,
        "drop-to-disk": new_d2d,
        "inject": new_inj,
        "drop_file": new_dropfile
    }
}
```

### Function Return

|Type|Description|
|----|-----------|
|Boolean|Status of update|

### Return Example

```
True
```